<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record id="view_woocommerce_import_wizard_form" model="ir.ui.view">
            <field name="name">woocommerce.import.wizard.form</field>
            <field name="model">woocommerce.import.wizard</field>
            <field name="arch" type="xml">
                <form string="Import Products from WooCommerce">
                    <header>
                        <field name="state" widget="statusbar" statusbar_visible="draft,importing,done"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <h1>Import Products from WooCommerce</h1>
                        </div>

                        <div class="alert alert-info" role="alert">
                            <h4><i class="fa fa-download"/> Import Process</h4>
                            <p>This wizard will import products from your WooCommerce store into Odoo. You can choose what to import and how to handle existing products.</p>
                            <p><strong>Tips:</strong></p>
                            <ul>
                                <li>Start with a small <strong>Import Limit</strong> to test the process</li>
                                <li>Enable <strong>Import Images</strong> to download product images</li>
                                <li>Enable <strong>Import Categories</strong> to sync product categories</li>
                                <li>Use <strong>Update if Exists</strong> to update existing products with new data</li>
                            </ul>
                        </div>

                        <group>
                            <group>
                                <field name="connection_id" readonly="1"
                                       help="The WooCommerce connection to import from"/>
                                <field name="total_products" readonly="1"
                                       help="Total number of products available in your WooCommerce store"/>
                                <field name="import_limit" invisible="state != 'draft'"
                                       help="Maximum number of products to import. Leave empty or 0 to import all products. Recommended: Start with 10-20 products to test."/>
                                <field name="batch_size" invisible="state != 'draft'"
                                       help="Number of products to process in each batch. Smaller batches use less memory but take longer. Recommended: 10-50 products per batch."/>
                            </group>
                            <group>
                                <field name="import_categories" invisible="state != 'draft'"
                                       help="Import product categories from WooCommerce and create corresponding categories in Odoo"/>
                                <field name="auto_import_categories" invisible="state != 'draft'"
                                       help="Automatically import all WooCommerce categories after products are imported. This ensures all product categories are available in Odoo."/>
                                <field name="auto_import_coupons" invisible="state != 'draft'"
                                       help="Automatically import all WooCommerce coupons after products are imported. This helps track which products have associated coupons."/>
                                <field name="import_images" invisible="state != 'draft'"
                                       help="Download and import product images from WooCommerce"/>
                                <field name="image_download_mode" invisible="state != 'draft' or not import_images"
                                       help="Download: Save images to Odoo. Link: Only store image URLs (faster but requires internet to view)."/>
                                <field name="import_attributes" invisible="state != 'draft'"
                                       help="Import product attributes (size, color, etc.) from WooCommerce"/>
                            </group>
                        </group>

                        <group string="Import Behavior" invisible="state != 'draft'">
                            <group>
                                <field name="update_existing" invisible="state != 'draft'"/>
                                <field name="overwrite_existing" invisible="state != 'draft'"/>
                            </group>
                            <group>
                                <div class="alert alert-info" style="margin-top: 10px;">
                                    <strong>Note:</strong><br/>
                                    • <strong>Update if Exists:</strong> Updates existing products with new data<br/>
                                    • <strong>Overwrite Existing:</strong> Deletes and recreates products<br/>
                                    • If both unchecked: Skips existing products
                                </div>
                            </group>
                        </group>

                        <group invisible="state == 'draft'" string="Batch Progress">
                            <group string="Status">
                                <div style="margin-bottom: 10px;">
                                    <strong>Current Status:</strong><br/>
                                    Batch <field name="batches_completed" readonly="1" class="oe_inline"/> of 
                                    <field name="total_batches" readonly="1" class="oe_inline"/>
                                </div>
                            </group>
                            <group>
                                <field name="imported_count" readonly="1"/>
                                <field name="error_count" readonly="1"/>
                            </group>
                        </group>

                        <group invisible="state not in ['importing', 'done']">
                            <group colspan="2">
                                <field name="progress_message" readonly="1" nolabel="1" 
                                       style="font-weight: bold; color: #007bff; font-size: 14px;"/>
                                <separator string="Import Progress"/>
                                <field name="progress_percentage" readonly="1" widget="progressbar" 
                                       options="{'title': 'Progress'}"/>
                                <div style="margin-top: 10px;">
                                    <strong>Progress:</strong>
                                    <field name="progress_current" readonly="1" class="oe_inline"/> / 
                                    <field name="progress_total" readonly="1" class="oe_inline"/> products
                                </div>
                            </group>
                        </group>

                        <notebook invisible="state not in ['importing', 'done']">
                            <page string="Import Log" name="log">
                                <field name="log_message" readonly="1" widget="text" nolabel="1"/>
                            </page>
                        </notebook>

                    </sheet>
                    <footer>

                        <button name="action_start_import" 
                                type="object" 
                                string="Start Import" 
                                class="btn-primary" 
                                invisible="state != 'draft'"
                                confirm="Are you sure you want to start importing products from WooCommerce? This will process the products according to your settings."/>

                        <button name="action_process_next_batch" 
                                type="object" 
                                string="Process Next Batch" 
                                class="btn-success" 
                                invisible="state != 'importing'"/>

                        <button name="action_view_imported_products" 
                                type="object" 
                                string="View Imported Products" 
                                class="btn-success" 
                                invisible="state != 'done'"/>

                        <button string="Close" 
                                class="btn-secondary" 
                                special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <record id="action_woocommerce_import_wizard" model="ir.actions.act_window">
            <field name="name">Import Products from WooCommerce</field>
            <field name="res_model">woocommerce.import.wizard</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
            <field name="context">{}</field>
        </record>

    </data>
</odoo>
