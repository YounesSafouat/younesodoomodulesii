<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>Documentation - Module l10n_fr_partner_enrich_pappers</title>
    <style>
        body {
            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
            color: #333333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            color: #875A7B;
            font-size: 2.5em;
            margin-bottom: 30px;
        }

        h2 {
            color: #875A7B;
            font-size: 2em;
            margin-top: 40px;
        }

        h3 {
            color: #666666;
            font-size: 1.5em;
            margin-top: 30px;
        }

        ul {
            padding-left: 20px;
        }

        li {
            margin-bottom: 8px;
        }

        .section {
            margin-bottom: 40px;
        }

        .alert {
            background-color: #f8f9fa;
            border-left: 4px solid #875A7B;
            padding: 15px;
            margin: 20px 0;
        }

        code {
            background-color: #f8f9fa;
            padding: 2px 4px;
            border-radius: 4px;
            font-family: Monaco, Consolas, "Courier New", monospace;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Documentation Fonctionnelle - Module l10n_fr_partner_enrich_pappers</h1>

        <div class="section">
            <h2>Description</h2>
            <p>Le module <code>l10n_fr_partner_enrich_pappers</code> est une extension Odoo qui permet l'enrichissement
                automatique des données des entreprises françaises en utilisant l'API Pappers. Il facilite la
                récupération et la mise à jour des informations légales et administratives des partenaires commerciaux
                français.</p>
            
            <div class="oe_screenshot">
                <img src="banner.png" alt="Aperçu du module" style="width: 100%; margin-bottom: 20px;"/>
            </div>
        </div>

        <div class="section">
            <h2>Fonctionnalités Principales</h2>

            <h3>1. Enrichissement Automatique des Données</h3>
            <ul>
                <li>Enrichissement automatique des fiches partenaires lors de la création</li>
                <li>Détection automatique des numéros SIRET/SIREN dans le nom du partenaire</li>
                <li>Mise à jour des informations légales et administratives via l'API Pappers</li>
            </ul>

            <h3>2. Informations Disponibles</h3>
            <p>Le module ajoute les champs suivants aux fiches partenaires :</p>

            <h4>Identification</h4>
            <ul>
                <li>SIRET</li>
                <li>SIREN</li>
                <li>Numéro RCS (Registre du Commerce et des Sociétés)</li>
                <li>Type juridique (Personne morale/Personne physique)</li>
            </ul>

            <h4>Informations Légales</h4>
            <ul>
                <li>Forme juridique</li>
                <li>Date de création</li>
                <li>Date d'immatriculation RCS</li>
                <li>Statut RCS (Inscrit/Non inscrit/Radié)</li>
                <li>Montant du capital</li>
                <li>Devise du capital</li>
            </ul>

            <h4>Informations Commerciales</h4>
            <ul>
                <li>Description de l'activité</li>
                <li>Effectif</li>
                <li>Siège social (oui/non)</li>
                <li>État de l'entreprise (active/fermée)</li>
                <li>Date de fermeture (si applicable)</li>
            </ul>

            <h3>3. Filtres et Regroupements</h3>
            <p>Le module ajoute de nouveaux filtres dans la vue liste des partenaires :</p>
            <ul>
                <li>Sièges sociaux</li>
                <li>Entreprises actives</li>
                <li>Entreprises fermées</li>
                <li>Regroupement par type juridique</li>
                <li>Regroupement par forme juridique</li>
                <li>Regroupement par statut RCS</li>
            </ul>

            <h3>4. Configuration</h3>
            <p>Dans les paramètres de configuration (Settings > Général > Pappers API) :</p>
            <div class="oe_screenshot">
                <img src="settings.png" alt="Configuration du module" style="width: 100%; margin-bottom: 20px;"/>
            </div>
            <ul>
                <li>Activation/désactivation du module</li>
                <li>Configuration de la clé API Pappers</li>
                <li>Configuration de l'URL de l'API</li>
                <li>Suivi des jetons pay-as-you-go restants</li>
                <li>Option pour masquer l'onglet Pappers dans la fiche partenaire</li>
            </ul>

            <h3>5. Mapping des Champs</h3>
            <p>Le module intègre un système de mapping des champs personnalisable :</p>
            <ul>
                <li>Mapping par défaut des champs Pappers vers les champs Odoo</li>
                <li>Possibilité de personnaliser les mappings via l'interface d'administration</li>
                <li>Validation automatique des champs Odoo existants</li>
            </ul>

            <h3>6. Suivi des Jetons API</h3>
            <div class="alert">
                <p>Le module intègre un système automatique de suivi des jetons API :</p>
                <div class="oe_screenshot">
                    <img src="settings.png" alt="Suivi des jetons" style="width: 100%; margin-bottom: 20px;"/>
                </div>
                <ul>
                    <li>Mise à jour automatique toutes les heures du nombre de jetons pay-as-you-go restants</li>
                    <li>Affichage du solde dans les paramètres de configuration</li>
                    <li>Possibilité de rafraîchir manuellement le compteur via un bouton dédié</li>
                    <li>Journalisation des mises à jour et des erreurs éventuelles</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>Prérequis</h2>
            <div class="alert">
                <ul>
                    <li>Une clé API Pappers valide (disponible sur <a href="https://www.pappers.fr/api"
                            target="_blank">https://www.pappers.fr/api</a>)</li>
                    <li>Connexion Internet pour accéder à l'API Pappers</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>Utilisation</h2>

            <h3>Configuration Initiale</h3>
            <ol>
                <li>Installer le module</li>
                <li>Aller dans Configuration > Paramètres généraux</li>
                <li>Dans la section "Pappers API", activer l'option "Enrichissement des données des entreprises
                    françaises"</li>
                <li>Saisir la clé API Pappers</li>
                <li>Configurer l'URL de l'API (par défaut : https://api.pappers.fr/v2)</li>
                <li>Optionnel : Configurer les mappings de champs dans Contacts > Configuration > Pappers Field Mapping</li>
            </ol>

            <h3>Configuration des Mappings de Champs</h3>
            <ol>
                <li>Accéder à Contacts > Configuration > Pappers Field Mapping</li>
                <li>Les mappings par défaut sont automatiquement créés</li>
                <li>Pour chaque mapping :
                    <ul>
                        <li>Champ Odoo : nom technique du champ dans Odoo (ex: name, slistt, siret_pappers)</li>
                        <li>Champ Pappers : chemin du champ dans l'API Pappers (ex: siren, siege.code_postal)</li>
                        <li>Actif : permet d'activer/désactiver le mapping</li>
                    </ul>
                </li>
                <li>Les modifications sont appliquées immédiatement</li>
            </ol>

            <h3>Création d'un Nouveau Partenaire</h3>
            <ol>
                <li>Créer un nouveau partenaire</li>
                <li>Si un numéro SIRET ou SIREN est saisi dans le nom, les informations sont automatiquement récupérées
                </li>
                <li>Les données sont automatiquement remplies dans l'onglet "Informations légales"</li>
            </ol>

            <h3>Consultation des Informations</h3>
            <p>Les informations légales sont accessibles dans un nouvel onglet "Pappers Data" de la fiche partenaire :</p>
            <div class="oe_screenshot">
                <img src="partner_form.png" alt="Fiche partenaire" style="width: 100%; margin-bottom: 20px;"/>
            </div>
        </div>

        <div class="section">
            <h2>Sécurité et Confidentialité</h2>
            <ul>
                <li>Les clés API sont stockées de manière sécurisée</li>
                <li>Les informations sensibles sont masquées dans l'interface</li>
                <li>Les accès aux données techniques sont restreints aux administrateurs</li>
            </ul>
        </div>

        <div class="section">
            <h2>Support et Maintenance</h2>
            <ul>
                <li>Le module vérifie automatiquement la validité de la clé API</li>
                <li>Les erreurs d'API sont gérées et notifiées à l'utilisateur</li>
                <li>Un système de logging permet de tracer les appels API et les erreurs éventuelles</li>
            </ul>
        </div>

        <div class="section">
            <h2>Limitations</h2>
            <div class="alert">
                <ul>
                    <li>Le module ne fonctionne qu'avec les entreprises françaises</li>
                    <li>Certaines informations peuvent ne pas être disponibles selon le niveau d'accès de l'API Pappers</li>
                    <li>Les mises à jour des données ne sont pas automatiques après la création initiale</li>
                    <li>Le compteur de jetons n'affiche que les jetons pay-as-you-go restants, et non les jetons inclus dans l'abonnement</li>
                    <li>La mise à jour du compteur de jetons est effectuée toutes les heures, il peut donc y avoir un léger décalage avec l'utilisation réelle</li>
                    <li>Les mappings de champs ne peuvent être configurés que par les administrateurs</li>
                    <li>Les champs Odoo référencés dans les mappings doivent exister dans le modèle res.partner</li>
                    <li>Les champs imbriqués dans l'API Pappers doivent être référencés avec la notation point (ex: siege.code_postal)</li>
                </ul>
            </div>
        </div>
    </div>
</body>

</html>